<!-- Form pour saisir les détails de la réservation -->
<form>
    <label for="service">Service:</label>
    <select id="service" name="service">
      <option value="massage">Massage</option>
      <option value="coiffure">Coiffure</option>
      <option value="manucure">Manucure</option>
    </select>
  
    <label for="employee">Employé:</label>
    <select id="employee" name="employee">
      <option value="1">John Doe</option>
      <option value="2">Jane Smith</option>
      <option value="3">Bob Johnson</option>
    </select>
  
    <label for="start-date">Date de début:</label>
    <input type="datetime-local" id="start-date" name="start-date">
    
    <label for="end-date">Date de fin:</label>
    <input type="datetime-local" id="end-date" name="end-date">
    
    <label for="location">Lieu:</label>
    <input type="text" id="location" name="location">
    
    <label for="summary">Résumé:</label>
    <input type="text" id="summary" name="summary">
    
    <!-- Bouton d'export iCalendar -->
    <button type="button" id="export-calendar-btn">Exporter vers l'agenda</button>
  </form>

  <script>
    // Ajouter un gestionnaire d'événement au bouton
    document.getElementById("export-calendar-btn").addEventListener("click", exportToCalendar);
  
    // Fonction pour exporter les détails de la réservation au format iCalendar
    function exportToCalendar() {
      // Récupérer les détails de la réservation à partir du formulaire
      var service = document.getElementById("service").value;
      var employee = document.getElementById("employee").value;
      var startDate = document.getElementById("start-date").value = new Date().toISOString().slice(0, 16);
      var endDate = document.getElementById("end-date").value;
      var location = document.getElementById("location").value;
      var summary = service + " avec " + employee;
      // Créer un fichier iCalendar avec les détails de la réservation
      var icsFile = createIcsFile(startDate, endDate, location, summary);
  
      // Forcer le téléchargement du fichier iCalendar
      downloadIcsFile(icsFile, "reservation.ics");
    }
    function createIcsFile(startDate, endDate, location, summary) {
        // Construction de contenu de fichier iCalendar
        var icsFileContent = "BEGIN:VCALENDAR\n";
        icsFileContent += "VERSION:2.0\n";
        icsFileContent += "BEGIN:VEVENT\n";
        icsFileContent += "DTSTART:" + startDate + "\n";
        icsFileContent += "DTEND:" + endDate + "\n";
        icsFileContent += "LOCATION:" + location + "\n";
        icsFileContent += "SUMMARY:" + summary + "\n";
        icsFileContent += "END:VEVENT\n";
        icsFileContent += "END:VCALENDAR\n";
    
        return icsFileContent;
      }
        // Fonction pour télécharger un fichier iCalendar
  function downloadIcsFile(icsFileContent, fileName) {
    var blob = new Blob([icsFileContent], { type: "text/calendar;charset=utf-8" });
    var link = document.createElement("a");
    link.href = window.URL.createObjectURL(blob);
    link.download = fileName;
    link.click();
  }
  </script>
